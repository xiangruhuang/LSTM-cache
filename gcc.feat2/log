I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
[2569 2514 5197 ...,  272 5521 1983]
#samples=7062, #lines=2118600
spliting samples w.r.t. (train:test:valid) = (5296:1765:1)
(1588800,)
splitting /home/xiangru/Projects/LSTM-cache/./data/dnn_ordered_traces/gcc/gcc.feat2.train, 38400 lines per file...
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
padding /home/xiangru/Projects/LSTM-cache/./data/dnn_ordered_traces/gcc/gcc.feat2.train.0041...
splitting /home/xiangru/Projects/LSTM-cache/./data/dnn_ordered_traces/gcc/gcc.feat2.test, 38400 lines per file...
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcublas.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcudnn.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcufft.so locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcuda.so.1 locally
I tensorflow/stream_executor/dso_loader.cc:128] successfully opened CUDA library libcurand.so locally
padding /home/xiangru/Projects/LSTM-cache/./data/dnn_ordered_traces/gcc/gcc.feat2.test.0013...
dataset= gcc , #instr= 3280
Config:
	learning rate=0.0001
	lr decay=0.99
	max epoch=100
	num layers=2
	hidden size=200
	keep prob=1.0
	num steps=300
	input dim=101
	output dim=1
	batch size=128
Building Computation Graph
train: 42 batches
test: 14 batches
initializing LSTM Model:
	 #hidden units=200, #layers=2
(102,)
(300, TensorShape([Dimension(128), Dimension(101)]))
[(u'LSTM_model/Variable:0', TensorShape([Dimension(200), Dimension(1)])), (u'LSTM_model/Variable_1:0', TensorShape([Dimension(1)])), (u'RNN/RNN/MultiRNNCell/Cell0/BasicLSTMCell/Linear/Matrix:0', TensorShape([Dimension(301), Dimension(800)])), (u'RNN/RNN/MultiRNNCell/Cell0/BasicLSTMCell/Linear/Bias:0', TensorShape([Dimension(800)])), (u'RNN/RNN/MultiRNNCell/Cell1/BasicLSTMCell/Linear/Matrix:0', TensorShape([Dimension(400), Dimension(800)])), (u'RNN/RNN/MultiRNNCell/Cell1/BasicLSTMCell/Linear/Bias:0', TensorShape([Dimension(800)]))]
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 0 with properties: 
name: GeForce GTX 1080
major: 6 minor: 1 memoryClockRate (GHz) 1.7335
pciBusID 0000:04:00.0
Total memory: 7.92GiB
Free memory: 7.81GiB
W tensorflow/stream_executor/cuda/cuda_driver.cc:590] creating context when one is currently active; existing: 0xa694d60
I tensorflow/core/common_runtime/gpu/gpu_device.cc:885] Found device 1 with properties: 
name: NVS 510
major: 3 minor: 0 memoryClockRate (GHz) 0.797
pciBusID 0000:03:00.0
Total memory: 1.95GiB
Free memory: 1.16GiB
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 0 and 1
I tensorflow/core/common_runtime/gpu/gpu_device.cc:777] Peer access not supported between device ordinals 1 and 0
I tensorflow/core/common_runtime/gpu/gpu_device.cc:906] DMA: 0 1 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 0:   Y N 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:916] 1:   N Y 
I tensorflow/core/common_runtime/gpu/gpu_device.cc:975] Creating TensorFlow device (/gpu:0) -> (device: 0, name: GeForce GTX 1080, pci bus id: 0000:04:00.0)
I tensorflow/core/common_runtime/gpu/gpu_device.cc:962] Ignoring gpu device (device: 1, name: NVS 510, pci bus id: 0000:03:00.0) with Cuda multiprocessor count: 1. The minimum required count is 8. You can adjust this requirement with the env var TF_MIN_GPU_MULTIPROCESSOR_COUNT.
models will be saved under ./gcc.feat2
epoch 0...
train_acc=0.849479, grad_norm=168450.112549
train_acc=0.790052, grad_norm=24901.140747
train_acc=0.812630, grad_norm=10349.163696
train_acc=0.778906, grad_norm=21412.464661
train_acc=0.807630, grad_norm=18262.388153
train_acc=0.836745, grad_norm=14413.629517
train_acc=0.838229, grad_norm=14310.906281
train_acc=0.797500, grad_norm=17379.806458
train_acc=0.790547, grad_norm=19267.925995
train_acc=0.826016, grad_norm=14755.548767
train_acc=0.818646, grad_norm=16054.592102
train_acc=0.824323, grad_norm=16320.162384
train_acc=0.876615, grad_norm=12355.759033
train_acc=0.840469, grad_norm=15853.158020
train_acc=0.818125, grad_norm=18729.455963
train_acc=0.800677, grad_norm=23994.795471
train_acc=0.783750, grad_norm=25140.324707
train_acc=0.834870, grad_norm=19275.880066
train_acc=0.833828, grad_norm=20314.309052
train_acc=0.870365, grad_norm=9044.380714
train_acc=0.805287, grad_norm=15731.495804
train_acc=0.774636, grad_norm=16478.616913
train_acc=0.800365, grad_norm=9954.042496
train_acc=0.773438, grad_norm=18339.274887
train_acc=0.826042, grad_norm=36169.298218
train_acc=0.817943, grad_norm=39060.162903
train_acc=0.830755, grad_norm=30316.928528
train_acc=0.856745, grad_norm=21125.515694
train_acc=0.816771, grad_norm=11182.177872
train_acc=0.897448, grad_norm=8005.531677
train_acc=0.823255, grad_norm=16675.496490
train_acc=0.822839, grad_norm=17864.555389
train_acc=0.846667, grad_norm=13384.999634
train_acc=0.838281, grad_norm=19682.427490
train_acc=0.821016, grad_norm=22387.949860
train_acc=0.864557, grad_norm=12101.535919
train_acc=0.827734, grad_norm=24544.602936
train_acc=0.817865, grad_norm=18747.038086
train_acc=0.872083, grad_norm=18130.699432
train_acc=0.873307, grad_norm=5613.038048
train_acc=0.900469, grad_norm=6756.024200
train_acc=0.871380, grad_norm=16752.185577
	Train acc=0.828769, cost=96064.892090, grad_norm=16752.185577
	test_acc=0.884479
	test_acc=0.875990
	test_acc=0.897708
	test_acc=0.895938
	test_acc=0.874922
	test_acc=0.897708
	test_acc=0.908880
	test_acc=0.875833
	test_acc=0.886146
	test_acc=0.901432
	test_acc=0.899167
	test_acc=0.872292
	test_acc=0.857083
	test_acc=0.917083
	Test acc=0.888904, Best acc=0.888904, countdown=0
epoch 1...
train_acc=0.870755, grad_norm=8340.857822
train_acc=0.871719, grad_norm=11038.071550
train_acc=0.910208, grad_norm=13247.691328
train_acc=0.886979, grad_norm=13497.263062
train_acc=0.872344, grad_norm=10342.611418
train_acc=0.884505, grad_norm=5155.690842
train_acc=0.865339, grad_norm=6839.467293
train_acc=0.892448, grad_norm=7414.481056
train_acc=0.907396, grad_norm=5548.470261
train_acc=0.846667, grad_norm=16038.167847
train_acc=0.858646, grad_norm=8702.463745
train_acc=0.881406, grad_norm=4560.801632
train_acc=0.909453, grad_norm=4816.822380
train_acc=0.897969, grad_norm=9047.858200
train_acc=0.876901, grad_norm=2091.915871
train_acc=0.887031, grad_norm=4609.003242
train_acc=0.866589, grad_norm=6008.373199
train_acc=0.922969, grad_norm=3681.611069
train_acc=0.893828, grad_norm=4308.232853
train_acc=0.912214, grad_norm=3133.451744
train_acc=0.911458, grad_norm=3023.638050
train_acc=0.898073, grad_norm=4025.486753
train_acc=0.904167, grad_norm=7458.532085
train_acc=0.903516, grad_norm=2235.407026
train_acc=0.895443, grad_norm=4603.295753
train_acc=0.883412, grad_norm=10622.985687
train_acc=0.872031, grad_norm=4023.714897
train_acc=0.893724, grad_norm=6017.356766
train_acc=0.897786, grad_norm=6053.300034
train_acc=0.900833, grad_norm=2736.961834
train_acc=0.871849, grad_norm=1430.740652
train_acc=0.872552, grad_norm=3954.586369
train_acc=0.900703, grad_norm=12649.116425
train_acc=0.892839, grad_norm=1049.890199
train_acc=0.892266, grad_norm=12738.094971
train_acc=0.921120, grad_norm=2109.920002
train_acc=0.957500, grad_norm=1649.024223
train_acc=0.920000, grad_norm=5657.424141
train_acc=0.922188, grad_norm=8558.574890
train_acc=0.903151, grad_norm=5408.167934
train_acc=0.897188, grad_norm=1984.545309
train_acc=0.888203, grad_norm=2466.333771
	Train acc=0.893223, cost=59651.578430, grad_norm=2466.333771
	test_acc=0.902839
	test_acc=0.900000
	test_acc=0.916432
	test_acc=0.903776
	test_acc=0.890964
	test_acc=0.913151
	test_acc=0.922161
	test_acc=0.892917
	test_acc=0.904453
	test_acc=0.906146
	test_acc=0.914870
	test_acc=0.896693
	test_acc=0.889219
	test_acc=0.926380
	Test acc=0.905714, Best acc=0.905714, countdown=0
epoch 2...
train_acc=0.903750, grad_norm=5043.873146
train_acc=0.923568, grad_norm=1952.453117
train_acc=0.921172, grad_norm=1550.010855
train_acc=0.905156, grad_norm=4843.956665
train_acc=0.917396, grad_norm=1329.377712
train_acc=0.878255, grad_norm=1906.460606
train_acc=0.911615, grad_norm=2968.969545
train_acc=0.898620, grad_norm=739.242250
train_acc=0.877109, grad_norm=2946.618168
train_acc=0.919375, grad_norm=6412.862648
train_acc=0.886719, grad_norm=7940.351334
train_acc=0.887552, grad_norm=2623.848530
train_acc=0.875339, grad_norm=5825.062241
train_acc=0.900885, grad_norm=1693.876297
train_acc=0.889219, grad_norm=7310.283234
train_acc=0.876432, grad_norm=4693.330589
train_acc=0.912891, grad_norm=4545.202103
train_acc=0.899818, grad_norm=1964.523623
train_acc=0.908958, grad_norm=10129.398239
train_acc=0.894141, grad_norm=2173.836102
train_acc=0.896823, grad_norm=6038.474945
train_acc=0.961797, grad_norm=4870.327465
train_acc=0.894089, grad_norm=1516.847834
train_acc=0.889010, grad_norm=6440.507912
train_acc=0.897891, grad_norm=1592.678892
train_acc=0.923490, grad_norm=8223.853317
train_acc=0.895573, grad_norm=3160.767113
train_acc=0.877083, grad_norm=12224.997314
train_acc=0.907656, grad_norm=6654.333511
train_acc=0.912604, grad_norm=10862.155289
train_acc=0.933542, grad_norm=2956.447220
train_acc=0.883724, grad_norm=5950.601295
train_acc=0.911901, grad_norm=3725.168478
train_acc=0.930286, grad_norm=4623.926534
train_acc=0.901745, grad_norm=4176.336185
train_acc=0.889714, grad_norm=4241.406013
train_acc=0.907135, grad_norm=2442.184814
train_acc=0.914453, grad_norm=8129.523666
train_acc=0.882760, grad_norm=4733.817787
train_acc=0.921276, grad_norm=3545.069889
train_acc=0.904479, grad_norm=2087.612465
train_acc=0.908776, grad_norm=2149.928925
	Train acc=0.903185, cost=56894.500244, grad_norm=2149.928925
	test_acc=0.898568
	test_acc=0.907266
	test_acc=0.923203
	test_acc=0.906328
	test_acc=0.896224
	test_acc=0.918099
	test_acc=0.926979
	test_acc=0.900599
	test_acc=0.910990
	test_acc=0.908698
	test_acc=0.922578
	test_acc=0.903646
	test_acc=0.900729
	test_acc=0.929063
	Test acc=0.910926, Best acc=0.910926, countdown=0
epoch 3...
train_acc=0.881719, grad_norm=12924.893494
train_acc=0.911693, grad_norm=6827.874016
train_acc=0.915755, grad_norm=6197.195251
train_acc=0.930807, grad_norm=3871.104134
train_acc=0.913359, grad_norm=3052.679955
train_acc=0.881979, grad_norm=1347.683771
train_acc=0.919583, grad_norm=6267.345451
train_acc=0.907344, grad_norm=5943.186638
train_acc=0.915286, grad_norm=2412.053677
train_acc=0.923958, grad_norm=9282.364395
train_acc=0.893932, grad_norm=4420.513222
train_acc=0.904766, grad_norm=4274.198360
train_acc=0.917161, grad_norm=4723.583141
train_acc=0.936120, grad_norm=1448.988197
train_acc=0.924375, grad_norm=1521.436123
train_acc=0.963984, grad_norm=1627.036428
train_acc=0.914792, grad_norm=8989.471802
train_acc=0.889141, grad_norm=3305.349037
train_acc=0.876979, grad_norm=2316.109978
train_acc=0.880234, grad_norm=5333.374496
train_acc=0.924557, grad_norm=5643.598648
train_acc=0.898880, grad_norm=4956.105228
train_acc=0.883854, grad_norm=5237.428299
train_acc=0.899948, grad_norm=1729.075911
train_acc=0.921042, grad_norm=2136.140760
train_acc=0.904531, grad_norm=3240.545975
train_acc=0.917057, grad_norm=6839.529121
train_acc=0.892500, grad_norm=6935.076897
train_acc=0.900052, grad_norm=4341.685135
train_acc=0.905286, grad_norm=2795.242458
train_acc=0.909583, grad_norm=1206.272570
train_acc=0.908750, grad_norm=5257.500244
train_acc=0.889193, grad_norm=1041.723166
train_acc=0.932604, grad_norm=2700.994072
train_acc=0.898151, grad_norm=1147.323271
train_acc=0.908828, grad_norm=3162.562153
train_acc=0.895859, grad_norm=7707.969170
train_acc=0.903672, grad_norm=3969.479237
train_acc=0.884818, grad_norm=6911.982399
train_acc=0.882787, grad_norm=7981.710487
train_acc=0.890417, grad_norm=14563.445221
train_acc=0.898984, grad_norm=4059.217203
	Train acc=0.906055, cost=55335.898315, grad_norm=4059.217203
	test_acc=0.899037
	test_acc=0.908594
	test_acc=0.925729
	test_acc=0.908464
	test_acc=0.897188
	test_acc=0.920339
	test_acc=0.928698
	test_acc=0.902396
	test_acc=0.911745
	test_acc=0.911224
	test_acc=0.922995
	test_acc=0.907370
	test_acc=0.902031
	test_acc=0.929740
	Test acc=0.912539, Best acc=0.912539, countdown=0
epoch 4...
train_acc=0.893464, grad_norm=8224.134827
train_acc=0.908438, grad_norm=3902.750370
train_acc=0.922865, grad_norm=3919.045341
train_acc=0.900859, grad_norm=1799.428703
train_acc=0.917760, grad_norm=6001.471992
train_acc=0.909141, grad_norm=6384.950882
train_acc=0.924662, grad_norm=9923.475571
train_acc=0.910469, grad_norm=4340.570091
train_acc=0.935443, grad_norm=2614.310989
train_acc=0.924844, grad_norm=4679.153507
train_acc=0.914089, grad_norm=1207.168056
train_acc=0.963516, grad_norm=1598.793272
train_acc=0.881875, grad_norm=8544.790489
train_acc=0.877630, grad_norm=2682.558090
train_acc=0.906172, grad_norm=2303.256720
train_acc=0.916979, grad_norm=2450.933468
train_acc=0.896302, grad_norm=4363.700413
train_acc=0.891719, grad_norm=11670.541473
train_acc=0.920286, grad_norm=4498.531212
train_acc=0.884089, grad_norm=8399.712631
train_acc=0.900703, grad_norm=6488.991913
train_acc=0.899427, grad_norm=1834.539749
train_acc=0.918255, grad_norm=11001.201340
train_acc=0.896979, grad_norm=4738.091282
train_acc=0.890938, grad_norm=11996.556122
train_acc=0.922656, grad_norm=3700.359039
train_acc=0.933073, grad_norm=2432.352657
train_acc=0.885547, grad_norm=9730.935371
train_acc=0.919297, grad_norm=4585.110928
train_acc=0.903229, grad_norm=6763.221924
train_acc=0.905339, grad_norm=6809.826210
train_acc=0.903359, grad_norm=6859.951797
train_acc=0.884089, grad_norm=9356.933952
train_acc=0.915911, grad_norm=2609.112724
train_acc=0.908516, grad_norm=7816.608067
train_acc=0.883672, grad_norm=13149.352036
train_acc=0.906198, grad_norm=2506.688286
train_acc=0.932422, grad_norm=3215.452324
train_acc=0.922865, grad_norm=16877.405350
train_acc=0.891823, grad_norm=8291.033546
train_acc=0.889193, grad_norm=12349.204140
train_acc=0.907005, grad_norm=7423.748211
	Train acc=0.907645, cost=53540.491760, grad_norm=7423.748211
	test_acc=0.900260
	test_acc=0.910625
	test_acc=0.928516
	test_acc=0.910990
	test_acc=0.899948
	test_acc=0.921771
	test_acc=0.932552
	test_acc=0.903880
	test_acc=0.912135
	test_acc=0.912786
	test_acc=0.921510
	test_acc=0.910104
	test_acc=0.901823
	test_acc=0.931016
	Test acc=0.914137, Best acc=0.914137, countdown=0
epoch 5...
train_acc=0.907109, grad_norm=27829.509254
train_acc=0.918359, grad_norm=8361.847786
train_acc=0.930469, grad_norm=5548.027393
train_acc=0.906432, grad_norm=4057.779511
train_acc=0.915938, grad_norm=9755.001022
train_acc=0.901745, grad_norm=3391.521851
train_acc=0.890287, grad_norm=4428.501677
train_acc=0.883828, grad_norm=16134.535904
train_acc=0.933021, grad_norm=2480.367100
train_acc=0.909844, grad_norm=5676.242432
train_acc=0.910885, grad_norm=5271.885151
train_acc=0.923828, grad_norm=22126.633812
train_acc=0.966328, grad_norm=13432.099602
train_acc=0.902422, grad_norm=3783.949150
train_acc=0.925911, grad_norm=10214.518135
train_acc=0.903542, grad_norm=7038.777971
train_acc=0.891563, grad_norm=10638.046738
train_acc=0.887734, grad_norm=11779.221581
train_acc=0.899297, grad_norm=10719.527012
train_acc=0.884323, grad_norm=5296.156507
train_acc=0.898880, grad_norm=5553.590427
train_acc=0.906068, grad_norm=3078.049110
train_acc=0.893464, grad_norm=35060.986572
train_acc=0.923958, grad_norm=17991.358261
train_acc=0.913177, grad_norm=8291.328178
train_acc=0.897344, grad_norm=7637.064270
train_acc=0.910130, grad_norm=9546.560738
train_acc=0.922318, grad_norm=12520.944183
train_acc=0.918385, grad_norm=20178.842438
train_acc=0.876823, grad_norm=6301.507439
train_acc=0.931354, grad_norm=4005.416927
train_acc=0.914427, grad_norm=17540.824738
train_acc=0.931823, grad_norm=14052.109856
train_acc=0.892552, grad_norm=2109.682024
train_acc=0.924688, grad_norm=7364.628845
train_acc=0.900234, grad_norm=5344.998039
train_acc=0.912656, grad_norm=3103.586266
train_acc=0.936901, grad_norm=2463.429811
train_acc=0.882734, grad_norm=12628.356857
train_acc=0.905807, grad_norm=4176.898392
train_acc=0.887344, grad_norm=16859.926758
train_acc=0.915547, grad_norm=14446.443810
	Train acc=0.909273, cost=52034.450195, grad_norm=14446.443810
	test_acc=0.899323
	test_acc=0.909193
	test_acc=0.927656
	test_acc=0.911667
	test_acc=0.898594
	test_acc=0.922708
	test_acc=0.930313
	test_acc=0.905469
	test_acc=0.914167
	test_acc=0.912839
	test_acc=0.922917
	test_acc=0.910755
	test_acc=0.903125
	test_acc=0.930599
	Test acc=0.914237, Best acc=0.914237, countdown=0
epoch 6...
train_acc=0.915781, grad_norm=1916.199789
train_acc=0.918906, grad_norm=6726.436054
train_acc=0.916432, grad_norm=2650.150215
train_acc=0.932708, grad_norm=14634.281150
train_acc=0.965859, grad_norm=10004.485241
W tensorflow/core/kernels/queue_base.cc:294] _1_readers/input_producer_1: Skipping cancelled enqueue attempt with queue not closed
W tensorflow/core/kernels/queue_base.cc:294] _0_readers/input_producer: Skipping cancelled enqueue attempt with queue not closed
Traceback (most recent call last):
  File "main.py", line 283, in <module>
    
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/platform/app.py", line 43, in run
    sys.exit(main(sys.argv[:1] + flags_passthrough))
  File "main.py", line 161, in main
    #run_options = tf.RunOptions(trace_level=tf.RunOptions.FULL_TRACE)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 766, in run
    run_metadata_ptr)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 964, in _run
    feed_dict_string, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1014, in _do_run
    target_list, options, run_metadata)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1021, in _do_call
    return fn(*args)
  File "/usr/local/lib/python2.7/dist-packages/tensorflow/python/client/session.py", line 1003, in _run_fn
    status, run_metadata)
KeyboardInterrupt
